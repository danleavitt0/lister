/** @jsx element */

import vdux from 'vdux/dom'
import element from 'vdux/element'
import ready from 'domready'
import fire from './src/index'
import mw from './src/middleware'
import flo from 'redux-flo'

/**
 * Initialize the app
 */
const Inner = {
  initialState () {
    return 5
  },
  render ({props}) {
    return (
      <div>
        hello {props}
      </div>
    )
  }
}

const Counter = fire((props) => ({
  game: 'gameTypes'
}))({
  render: Inner.render
})

const initialState = {
  counter: 0
}

const config = {
  apiKey: 'AIzaSyA1Ib5i5HZPCxnKp4ITiUoy5VEKaLMdsDY',
  databaseURL: 'https://play-ev3.firebaseio.com'
}

function reducer (state, action) {
  if (action.type === 'INCREMENT') {
    return {...state, counter: state.counter + 1}
  }

  return state
}

const {subscribe, render} = vdux({reducer, initialState, middleware: [flo(), mw(config)]})

ready(() => {
  subscribe((state) => {
    render(<Counter {...state}/>)
  })
})
